import{a as g}from"./axios-c0bebe37.js";import{_ as C,r as a,o as b,c as D,f as e,g as l,h as n,t as s,a as i,F as N,e as V}from"./index-d39f5865.js";const A={data(){return{doc_api:"http://127.0.0.1:8000/dmsAPi/document/1",document:{},api:"http://127.0.0.1:8000/dmsAPi/folder/",datalist:[],defaultProps:{children:"children",label:"folder_name"},path:"",dataList:[],fileData:{create_by:localStorage.username,update_by:localStorage.username,type:2,note:"note",document:1,folder:5},headerObj:{Authorization:"Token "+localStorage.token},previewPath:"",previewVisible:!1}},created(){this.getDocument(),this.getDataList()},methods:{getDocument(){g({url:this.doc_api,method:"get",headers:{Authorization:"Token "+localStorage.token}}).then(t=>{this.document=t.data,this.fileData.document=this.document.id}).catch(t=>{})},getDataList(){g({url:this.api,method:"get",headers:{Authorization:"Token "+localStorage.token}}).then(t=>{let d=t.data.results.filter(r=>r.p_id==0);d.forEach(r=>{r.children=t.data.results.filter(_=>_.p_id==r.id)}),this.datalist=d}).catch(t=>{})},handleNodeClick(t){this.fileData.folder=t.id;let d="";this.datalist.forEach(r=>{t.p_id==r.id&&(d=r.folder_name+"/")}),d==""?this.path="/"+t.folder_name:this.path="/"+d+"/"+t.folder_name},submitUpload(){this.$refs.upload.submit()},onchange(t,d){console.log(t),this.fileData.file_name=t.name,this.fileData.size=t.size},onSuccess(){this.$message.success("uploaded successfully")}}},L={class:"grid-content bg-purple"},P={class:"grid-content bg-purple-light"},B=i("i",{class:"el-icon-upload"},null,-1),T=i("div",{class:"el-upload__text"},[n("Drop file here or "),i("em",null,"click to upload")],-1),U={slot:"header",class:"clearfix"};function E(t,d,r,_,o,u){const c=a("el-descriptions-item"),m=a("el-tag"),k=a("el-descriptions"),v=a("el-alert"),y=a("el-tree"),h=a("el-col"),x=a("el-upload"),w=a("el-input"),z=a("el-button"),f=a("el-card"),S=a("el-row");return b(),D("div",null,[e(f,null,{default:l(()=>[e(k,{title:"Document"},{default:l(()=>[e(c,{label:"DocumentID"},{default:l(()=>[n(s(o.document.documentID),1)]),_:1}),e(c,{label:"Version"},{default:l(()=>[n("v"+s(o.document.version),1)]),_:1}),e(c,{label:"Letze Update"},{default:l(()=>[n(s(o.document.update_time),1)]),_:1}),e(c,{label:"Bearbeiter"},{default:l(()=>[n(s(o.document.create_by),1)]),_:1}),e(c,{label:"Status"},{default:l(()=>[e(m,{size:"small",type:"warning"},{default:l(()=>[n("Bearbeitung")]),_:1})]),_:1}),e(c,{label:"Notiz"},{default:l(()=>[n(s(o.document.note),1)]),_:1})]),_:1}),e(v,{title:"Achtung, Diese Dokument ist zur Zeit in der Bearbeitung.",type:"error"}),e(S,null,{default:l(()=>[e(h,{span:10},{default:l(()=>[i("div",L,[e(y,{data:o.datalist,accordion:"",onNodeClick:u.handleNodeClick,props:o.defaultProps},null,8,["data","onNodeClick","props"])])]),_:1}),e(h,{span:14},{default:l(()=>[i("div",P,[i("div",null,[i("p",null,s(o.path),1),e(x,{ref:"upload",drag:"",class:"upload-demo",name:"upload",action:"http://127.0.0.1:8000/dmsAPi/uploadFile/",headers:o.headerObj,data:o.fileData,"auto-upload":!1,"on-success":u.onSuccess,"on-preview":t.imgPreview,"on-change":u.onchange,style:{padding:"30px"}},{default:l(()=>[B,T]),_:1},8,["headers","data","on-success","on-preview","on-change"]),e(w,{modelValue:o.fileData.note,"onUpdate:modelValue":d[0]||(d[0]=p=>o.fileData.note=p),type:"textarea"},null,8,["modelValue"]),e(z,{style:{"margin-left":"100px"},type:"primary",onClick:u.submitUpload},{default:l(()=>[n("Upload")]),_:1},8,["onClick"])]),e(f,null,{default:l(()=>[i("div",U,[e(m,null,{default:l(()=>[n(s(o.path),1)]),_:1}),n(" "+s(o.fileData),1)]),(b(),D(N,null,V(4,p=>i("div",{key:p,class:"text item"},s("List itemddddddddddddddddddddddddddddddddddddddddddddddddd "+p),1)),64))]),_:1})])]),_:1})]),_:1})]),_:1})])}const I=C(A,[["render",E]]);export{I as default};
